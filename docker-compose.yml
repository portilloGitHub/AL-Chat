version: '3.8'

services:
  al-chat-backend:
    build:
      context: ./Backend
      dockerfile: Dockerfile
    container_name: al-chat-backend
    ports:
      - "5000:5000"
    environment:
      - FLASK_ENV=development
      - PORT=5000
      # For local testing, set OPENAI_API_KEY here or use .env file
      # For production, this will come from main website's auth
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENAI_MODEL=${OPENAI_MODEL:-gpt-3.5-turbo}
      - AL_CHAT_LOG_DIR=/app/SessionLog
    volumes:
      # Mount SessionLog for persistence (optional)
      - ./SessionLog:/app/SessionLog
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    networks:
      - al-chat-network

  # Frontend is handled by main website project
  # AL-Chat is backend-only API service

networks:
  al-chat-network:
    driver: bridge
